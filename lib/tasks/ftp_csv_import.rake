namespace :fci do
  desc "import csv file from server"

  # task :import_file => :environment do
  #   FTPCsvImport.retrieve_csv_file
  # end

  # task :update_file => :environment do
  #   FTPCsvImport.update_csv_file
  # end
  task :retrieve_csv_and_import_orders => :environment do
  	FTPCsvImport.retrieve_csv_file
  	# url ='StoreSettingsController/csvDoImport'
  	# settings_controller = StoreSettingsController.new
  	# post settings_controller.csvDoImport, { "rows"=>2, "sep"=>",", "other_sep"=>0, "delimiter"=>"\"", "fix_width"=>0, "fixed_width"=>4, "import_action"=>nil, "contains_unique_order_items"=>true, "generate_barcode_from_sku"=>"[FILTERED]", "use_sku_as_product_name"=>false, "order_date_time_format"=>"MM/DD/YYYY TIME", "day_month_sequence"=>"DD/MM", "map"=>{"0"=>{"name"=>"Order Date/Time", "value"=>"order_placed_time"}, "1"=>{"name"=>"Category Name", "value"=>"category"}, "2"=>{"name"=>"Order number", "value"=>"increment_id"}, "3"=>{"name"=>"(First) Name", "value"=>"firstname"}, "4"=>{"name"=>"Address 1", "value"=>"address_1"}, "5"=>{"name"=>"Postal Code", "value"=>"postcode"}, "6"=>{"name"=>"SKU", "value"=>"sku"}, "7"=>{"name"=>"Product Name", "value"=>"product_name"}, "8"=>{"name"=>"Product Instructions", "value"=>"product_instructions"}, "9"=>{"name"=>"Quantity", "value"=>"qty"}, "10"=>{"name"=>"Image URL", "value"=>"image"}}, "store_id"=>18, "type"=>"order", "name"=>"Sample CSV - Default Order Map", "data"=>[["16-06-2015 14:15", "PIRANHA", "W100028969", "Laura White", "28 Kenyngton Drive", "TW16 7RX", "P-10878", "Engraved Large Heart Motif Slate Heart", "Jessica|Andrew|Married On|26th June 2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:16", "PIRANHA", "P100122064", "Kerrie McKie", "41 Yew Tree Lane", "NG4 4AN", "P-10563-SET", "Engraved Slate Coasters - Heart and Initials", "K|R|29.05.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:17", "PIRANHA", "W100028973", "WESLEY CLARK", "6 Branton Close", "LU2 9TY", "P-10555-SET", "Engraved Slate Coasters - The New Mr and Mrs", "Mr & Mrs|McNaughton|04.07.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:18", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Grandad's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:19", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Daddy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:20", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "Maisy's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:21", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "William's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:22", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Mummy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"]], "head"=>[["DATE/TIME", "CATEGORY", "ORDERNUMBER", "SHIP_TO_NAME", "S_ADDRESS2", "S_POSTCODE", "SKU", "ITEM_NAME", "PRODUCT_INSTRUCITONS", "ITEM_QTY", "Item - Image URL"]], "store_setting"=>{"rows"=>2, "sep"=>",", "other_sep"=>0, "delimiter"=>"\"", "fix_width"=>0, "fixed_width"=>4, "import_action"=>nil, "contains_unique_order_items"=>true, "generate_barcode_from_sku"=>"[FILTERED]", "use_sku_as_product_name"=>false, "order_date_time_format"=>"MM/DD/YYYY TIME", "day_month_sequence"=>"DD/MM", "map"=>{"0"=>{"name"=>"Order Date/Time", "value"=>"order_placed_time"}, "1"=>{"name"=>"Category Name", "value"=>"category"}, "2"=>{"name"=>"Order number", "value"=>"increment_id"}, "3"=>{"name"=>"(First) Name", "value"=>"firstname"}, "4"=>{"name"=>"Address 1", "value"=>"address_1"}, "5"=>{"name"=>"Postal Code", "value"=>"postcode"}, "6"=>{"name"=>"SKU", "value"=>"sku"}, "7"=>{"name"=>"Product Name", "value"=>"product_name"}, "8"=>{"name"=>"Product Instructions", "value"=>"product_instructions"}, "9"=>{"name"=>"Quantity", "value"=>"qty"}, "10"=>{"name"=>"Image URL", "value"=>"image"}}, "store_id"=>18, "type"=>"order", "name"=>"Sample CSV - Default Order Map", "data"=>[["16-06-2015 14:15", "PIRANHA", "W100028969", "Laura White", "28 Kenyngton Drive", "TW16 7RX", "P-10878", "Engraved Large Heart Motif Slate Heart", "Jessica|Andrew|Married On|26th June 2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:16", "PIRANHA", "P100122064", "Kerrie McKie", "41 Yew Tree Lane", "NG4 4AN", "P-10563-SET", "Engraved Slate Coasters - Heart and Initials", "K|R|29.05.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:17", "PIRANHA", "W100028973", "WESLEY CLARK", "6 Branton Close", "LU2 9TY", "P-10555-SET", "Engraved Slate Coasters - The New Mr and Mrs", "Mr & Mrs|McNaughton|04.07.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:18", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Grandad's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:19", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Daddy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:20", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "Maisy's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:21", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "William's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:22", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Mummy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"]], "head"=>[["DATE/TIME", "CATEGORY", "ORDERNUMBER", "SHIP_TO_NAME", "S_ADDRESS2", "S_POSTCODE", "SKU", "ITEM_NAME", "PRODUCT_INSTRUCITONS", "ITEM_QTY", "Item - Image URL"]]}}
 #  	def api_json_get(url, params={ "rows"=>2, "sep"=>",", "other_sep"=>0, "delimiter"=>"\"", "fix_width"=>0, "fixed_width"=>4, "import_action"=>nil, "contains_unique_order_items"=>true, "generate_barcode_from_sku"=>"[FILTERED]", "use_sku_as_product_name"=>false, "order_date_time_format"=>"MM/DD/YYYY TIME", "day_month_sequence"=>"DD/MM", "map"=>{"0"=>{"name"=>"Order Date/Time", "value"=>"order_placed_time"}, "1"=>{"name"=>"Category Name", "value"=>"category"}, "2"=>{"name"=>"Order number", "value"=>"increment_id"}, "3"=>{"name"=>"(First) Name", "value"=>"firstname"}, "4"=>{"name"=>"Address 1", "value"=>"address_1"}, "5"=>{"name"=>"Postal Code", "value"=>"postcode"}, "6"=>{"name"=>"SKU", "value"=>"sku"}, "7"=>{"name"=>"Product Name", "value"=>"product_name"}, "8"=>{"name"=>"Product Instructions", "value"=>"product_instructions"}, "9"=>{"name"=>"Quantity", "value"=>"qty"}, "10"=>{"name"=>"Image URL", "value"=>"image"}}, "store_id"=>18, "type"=>"order", "name"=>"Sample CSV - Default Order Map", "data"=>[["16-06-2015 14:15", "PIRANHA", "W100028969", "Laura White", "28 Kenyngton Drive", "TW16 7RX", "P-10878", "Engraved Large Heart Motif Slate Heart", "Jessica|Andrew|Married On|26th June 2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:16", "PIRANHA", "P100122064", "Kerrie McKie", "41 Yew Tree Lane", "NG4 4AN", "P-10563-SET", "Engraved Slate Coasters - Heart and Initials", "K|R|29.05.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:17", "PIRANHA", "W100028973", "WESLEY CLARK", "6 Branton Close", "LU2 9TY", "P-10555-SET", "Engraved Slate Coasters - The New Mr and Mrs", "Mr & Mrs|McNaughton|04.07.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:18", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Grandad's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:19", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Daddy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:20", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "Maisy's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:21", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "William's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:22", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Mummy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"]], "head"=>[["DATE/TIME", "CATEGORY", "ORDERNUMBER", "SHIP_TO_NAME", "S_ADDRESS2", "S_POSTCODE", "SKU", "ITEM_NAME", "PRODUCT_INSTRUCITONS", "ITEM_QTY", "Item - Image URL"]], "store_setting"=>{"rows"=>2, "sep"=>",", "other_sep"=>0, "delimiter"=>"\"", "fix_width"=>0, "fixed_width"=>4, "import_action"=>nil, "contains_unique_order_items"=>true, "generate_barcode_from_sku"=>"[FILTERED]", "use_sku_as_product_name"=>false, "order_date_time_format"=>"MM/DD/YYYY TIME", "day_month_sequence"=>"DD/MM", "map"=>{"0"=>{"name"=>"Order Date/Time", "value"=>"order_placed_time"}, "1"=>{"name"=>"Category Name", "value"=>"category"}, "2"=>{"name"=>"Order number", "value"=>"increment_id"}, "3"=>{"name"=>"(First) Name", "value"=>"firstname"}, "4"=>{"name"=>"Address 1", "value"=>"address_1"}, "5"=>{"name"=>"Postal Code", "value"=>"postcode"}, "6"=>{"name"=>"SKU", "value"=>"sku"}, "7"=>{"name"=>"Product Name", "value"=>"product_name"}, "8"=>{"name"=>"Product Instructions", "value"=>"product_instructions"}, "9"=>{"name"=>"Quantity", "value"=>"qty"}, "10"=>{"name"=>"Image URL", "value"=>"image"}}, "store_id"=>18, "type"=>"order", "name"=>"Sample CSV - Default Order Map", "data"=>[["16-06-2015 14:15", "PIRANHA", "W100028969", "Laura White", "28 Kenyngton Drive", "TW16 7RX", "P-10878", "Engraved Large Heart Motif Slate Heart", "Jessica|Andrew|Married On|26th June 2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:16", "PIRANHA", "P100122064", "Kerrie McKie", "41 Yew Tree Lane", "NG4 4AN", "P-10563-SET", "Engraved Slate Coasters - Heart and Initials", "K|R|29.05.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:17", "PIRANHA", "W100028973", "WESLEY CLARK", "6 Branton Close", "LU2 9TY", "P-10555-SET", "Engraved Slate Coasters - The New Mr and Mrs", "Mr & Mrs|McNaughton|04.07.2015", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:18", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Grandad's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:19", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Daddy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:20", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "Maisy's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:21", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10433-250", "Personalised Storage Treats Jar ", "William's|Enjoy your sweets|Love mummy and daddy xx", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"], ["16-06-2015 14:22", "PIRANHA", "P100122076", "Lucy Jones", "11 Three Choirs Close", "HR9 5JD", "P-10467-250", "Personalised Storage Jar - Very Special Sweet Treat Jar", "Mummy's", "1", "http://i.ebayimg.com/00/s/NTAxWDUwMQ==/z/Bq4AAMXQ855Rpgnd/$T2eC16R,!)!E9s2fCHI4BRpgndCwzw~~60_1.JPG?set_id=880000500F"]], "head"=>[["DATE/TIME", "CATEGORY", "ORDERNUMBER", "SHIP_TO_NAME", "S_ADDRESS2", "S_POSTCODE", "SKU", "ITEM_NAME", "PRODUCT_INSTRUCITONS", "ITEM_QTY", "Item - Image URL"]]}})
	#   @rails_session ||= ActionDispatch::Integration::Session.new(Rails.application)
	#   @rails_session.get(url, { :format => :json }.merge(params))
	#   JSON.parse(@rails_session.response.body)
	#   puts @rails_session.response.body
	# end
	import_csv = ImportCsv.new
	import_csv.import('groovepacks_development', {:type=>"order", :fix_width=>0, :fixed_width=>4, :sep=>",", :delimiter=>"\"", :rows=>2, :map=>{"0"=>{"name"=>"Order Date/Time", "value"=>"order_placed_time"}, "1"=>{"name"=>"Category Name", "value"=>"category"}, "2"=>{"name"=>"Order number", "value"=>"increment_id"}, "3"=>{"name"=>"(First) Name", "value"=>"firstname"}, "4"=>{"name"=>"Address 1", "value"=>"address_1"}, "5"=>{"name"=>"Postal Code", "value"=>"postcode"}, "6"=>{"name"=>"SKU", "value"=>"sku"}, "7"=>{"name"=>"Product Name", "value"=>"product_name"}, "8"=>{"name"=>"Product Instructions", "value"=>"product_instructions"}, "9"=>{"name"=>"Quantity", "value"=>"qty"}, "10"=>{"name"=>"Image URL", "value"=>"image"}}, :store_id=>18, :import_action=>nil, :contains_unique_order_items=>true, :generate_barcode_from_sku=>false, :use_sku_as_product_name=>false, :order_placed_at=>nil, :order_date_time_format=>"MM/DD/YYYY TIME", :day_month_sequence=>"DD/MM"})
  	puts "completed import"
  	FTPCsvImport.update_csv_file
  	puts "updation complete"
  end
end
