<div class="row navigation-row">
    <div ng-include="'/assets/partials/navigation.html'"></div>
</div>

<div  class="row home-row">
    <div class="alert alert-danger" ng-show="show_error">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <p>{{error_msg}}</p>
    </div>
</div>

<div class="row home-row">
    <div class="span3 left-menu">
        <div class="accordion" id="accordion2">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                        Orders
                    </a>
                </div>
                <div id="collapseOne" class="accordion-body collapse in">
                    <div class="accordion-inner">
                        <ul class="nav nav-pills nav-stacked">
                            <li class="order_setup-filter order_setup-filter-all" ><a href="" ng-click="order_setup_opt('filter','all')">Show All</a></li>
                            <li class="order_setup-filter order_setup-filter-awaiting" ><a href="" ng-click="order_setup_opt('filter','awaiting')">Awaiting</a></li>
                            <li class="order_setup-filter order_setup-filter-onhold"><a href="" ng-click="order_setup_opt('filter','onhold')">On Hold</a></li>
                            <li class="order_setup-filter order_setup-filter-cancelled"><a href="" ng-click="order_setup_opt('filter','cancelled')">Cancelled</a></li>
                            <li class="order_setup-filter order_setup-filter-scanned"><a href="" ng-click="order_setup_opt('filter','scanned')">Scanned</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="span8">
        <div class="well">
            <div class="row-fluid">

                <div class="span4 pull-right">
                    <ul class="nav nav-pills">
                        <li class="dropdown">
                            <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="#">Edit <b class="caret"></b></a>
                            <ul id="menu2" class="dropdown-menu" role="menu" aria-labelledby="drop4">
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_delete()">Delete</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_duplicate()">Duplicate</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a class="dropdown-toggle" id="drop5" role="button" data-toggle="dropdown" href="#">Change Status
                                <b class="caret"></b></a>
                            <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop5">
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_change_status('awaiting')">Awaiting</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_change_status('onhold')">On Hold</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_change_status('cancelled')">Cancelled</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="order_change_status('scanned')">Scanned</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <table id="orderstbl" class="table table-hover table-bordered" infinite-scroll="order_next()">
                <thead>
                <tr>
                    <th>
                        <input ng-model="order_setup.select_all" type="checkbox" ng-change='select_all_toggle()' />
                    </th>
                    <th>
                        Tags
                    </th>
                    <th class="order_setup-sort order_setup-sort-store">
                        <a href="" ng-click="order_setup_opt('sort','store')">Store<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-notes">
                        <a href="" ng-click="order_setup_opt('sort','notes')">Notes<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-store_order_id">
                        <a href="" ng-click="order_setup_opt('sort','store_order_id')">Order #<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-order_date">
                        <a href="" ng-click="order_setup_opt('sort','order_date')">Order Date<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-items">
                        <a href="" ng-click="order_setup_opt('sort','items')">Items<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-recipient">
                        <a href="" ng-click="order_setup_opt('sort','recipient')">Recipient<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>
                    <th class="order_setup-sort order_setup-sort-status">
                        <a href="" ng-click="order_setup_opt('sort','status')">Status<span class="{{'caret-'+order_setup.order}}"></span></a>
                    </th>

                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="order in orders">
                    <td><input type="checkbox" ng-model="order.checked"/></td>
                    <td></td>
                    <td>{{order.store_name}}</td>
                    <td>{{order.notes}}</td>
                    <td><a href="#showOrder" role="button" data-toggle="modal" ng-click="order_single_details(order.id)" class="ng-binding">{{order.ordernum}}</a></td>
                    <td>{{order.orderdate | date:'EEEE MM/dd/yyyy hh:mm:ss a'}}</td>
                    <td>{{order.itemslength}}</td>
                    <td>{{order.recipient}}</td>
                    <td>{{order.status}}</td>
                </tr>
                </tbody>
            </table>

        </div>
        <!-- show order modal -->
        <div id="showOrder" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="showOrder"
             aria-hidden="true">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
                <h3 id="showOrder-header">Order #{{single_order.basicinfo.increment_id}} Details</h3>
            </div>


            <div class="form-horizontal form-horizontal-create" >
            <fieldset>
                <div class="modal-body" id="showOrder-body">
                    <ul class="nav nav-tabs" id="myTab">
                        <li class="active"><a href="#infotab" data-toggle="tab">Information</a></li>
                        <li><a href="#itemstab" data-toggle="tab">Items</a></li>
                        <li><a href="#notestab" data-toggle="tab">Notes</a></li>
                        <li><a href="#actexceptab" data-toggle="tab">Activity & exceptions</a></li>
                    </ul>


                    <div class="tab-content">
                        <div class="alert alert-danger" ng-show="show_error_msgs">
                            <button type="button" class="close" data-dismiss="alert"><i class="icon-remove"></i></button>
                            <span ng-repeat="message in error_msgs">{{message}}</span>
                        </div>
                        <div class="tab-pane active" id="infotab">
                            <fieldset>
                                <legend>Product Details</legend>
                            <div class="row-fluid">
                                <div class="span6">
                                    <div class="control-group">
                                        <label class="control-label">First Name</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.firstname" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Last Name</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.lastname" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Company</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.company" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Address line 1</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.address_1" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Address line 2</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.address_2" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">City</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.city" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">State</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.state" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Zip</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.postcode" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Country</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.country" class="regular-input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="span6">
                                    <div class="control-group">
                                        <label class="control-label">Order #</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.increment_id" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Buyer Email</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.email" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Store Order id</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.store_order_id" class="regular-input" />
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Order Date</label>
                                        <div class="controls">
                                            <input xs-input-sync type="text" ng-model="single_order.basicinfo.order_placed_time" class="regular-input" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </fieldset>
                            <fieldset>
                                <legend>Shipping Information</legend>
                                <div class="row-fluid">
                                    <div class="span6">
                                        <div class="control-group">
                                            <label class="control-label">Scanned on</label>
                                            <div class="controls">
                                                <input xs-input-sync type="text" ng-model="single_order.basicinfo.scanned_on" class="regular-input" />
                                            </div>
                                        </div>

                                    </div>
                                    <div class="span6">

                                        <div class="control-group">
                                            <label class="control-label">Tracking id #</label>
                                            <div class="controls">
                                                <input xs-input-sync type="text" ng-model="single_order.basicinfo.tracking_num" class="regular-input" />
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </fieldset>
                        </div>


                        <div class="tab-pane" id="itemstab">
                            <div class="control-group pull-right" ng-show="single_order.remove_items_permitted">
                                <div class="controls">
                                    <button class="btn btn-danger" ng-click="item_remove_selected()">Remove selected Items</button>
                                </div>
                            </div>


                            <table class="table table-hover table-bordered" >
                                <thead>
                                <tr >
                                    <th><input ng-model="items_select" type="checkbox" ng-change='item_select_all_toggle()' /></th>
                                    <th>Product</th>
                                    <th>Primary Image</th>
                                    <th>Primary SKU</th>
                                    <th>Location</th>
                                    <th>Qty ordered</th>
                                    <th>On hand</th>
                                    <th>Is Skippable</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="item in single_order.items" ng-click="item.checked = !item.checked">
                                    <td><input type="checkbox" ng-model="item.checked"/></td>
                                    <td>{{ item.productinfo.name }}</td>
                                    <td> <div class="single-image"><img class="img-thumb" ng-src="{{item.productimages[0].image}}" /></div></td>
                                    <td>{{item.iteminfo.sku}}</td>
                                    <td>{{item.productinfo.alternate_location}}</td>
                                    <td>{{item.iteminfo.qty}}</td>
                                    <td>{{item.productinfo.inv_wh1}}</td>
                                    <td><input type="checkbox" ng-model="item.productinfo.is_skippable"/></td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="control-group pull-right"  ng-show="single_order.add_items_permitted">
                                <div class="controls">
                                    <button class="btn" ng-click="item_order()">Add Item</button>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="notestab">
                            <fieldset>
                                <legend>Internal Notes</legend>
                                <textarea xs-input-sync ng-model="single_order.basicinfo.notes_internal" class="regular-input span12" rows="4"></textarea>
                            </fieldset>
                            <fieldset>
                                <legend>Notes to Packer</legend>
                                <textarea xs-input-sync size="span8" ng-model="single_order.basicinfo.notes_toPacker" class="regular-input span12" rows="4"></textarea>
                            </fieldset>
                            <fieldset>
                                <legend>Notes from Packer</legend>
                                <textarea xs-input-sync ng-model="single_order.basicinfo.notes_fromPacker" class="regular-input span12" rows="4"></textarea>
                            </fieldset>
                            <fieldset>
                                <legend>Customer Comments</legend>
                                <textarea xs-input-sync ng-model="single_order.basicinfo.customer_comments" class="regular-input span12" rows="4"></textarea>
                            </fieldset>
                        </div>
                        <div class="tab-pane" id="actexceptab">

                                <div class="row-fluid">
                                    <div class="span6">
                                        <fieldset>
                                            <legend>Activity Log</legend>
                                            <div class="control-group" ng-repeat="activity in single_order.activities">
                                                <h5>{{ activity.activitytime | date:'EEEE MM/dd/yyyy hh:mm:ss a'}}</h5>
                                                <div class="controls">
                                                    {{ activity.action}} - by: {{ activity.username }}
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                    <div class="span6">
                                        <fieldset>
                                            <legend>Packing Exceptions</legend>
                                            <div class="control-group">
                                                <label class="control-label">Reason</label>
                                                <div class="controls">
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="qty_related" /> Quantity Related
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="incorrect_item" /> Incorrect item
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="missing_item" /> Missing item
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="damaged_item" /> Damaged item
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="special_instruction" /> Special instruction related
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio" ng-model="single_order.exception.reason" value="other" /> Other
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <label class="control-label">Description (optional)</label>
                                                <div class="controls">
                                                    <textarea xs-input-sync ng-model="single_order.exception.description" class="span8" rows="4"></textarea>
                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <label class="control-label">Associate exception with</label>
                                                <div class="controls">
                                                    <label class="radio">
                                                        <input type="radio"  ng-model="single_order.exception.assoc" value="current" /> Current user
                                                    </label>
                                                    <label class="radio">
                                                        <input type="radio"  ng-model="single_order.exception.assoc" value="none" /> No user
                                                    </label>
                                                </div>
                                            </div>
                                            <button class="btn btn-primary" ng-click="update_order_exception()">Record Exception</button>
                                            <button class="btn btn-danger" ng-click="clear_order_exception()">Clear Exception</button>
                                        </fieldset>
                                    </div>
                                </div>

                        </div>

                    </div>
                </div>

                <div class="modal-footer">
                    <div class="row-fluid">
                        <div class="span6">
                            <span class="label label-info" id="order_update_status" ng-show="order_update_status">{{order_update_message}}</span>
                        </div>
                        <div class="span6">
                            <div class="pull-right">
                                <button class="btn btn-primary" ng-click="update_single_order()">Save</button>
                                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

            </fieldset>
            </div>
        </div>

<!-- Add item modal -->
        <div id="addItem" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="addItem"
             aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
                <h3 id="addItemHeader" >Select Item to add to Order</h3>
            </div>
            <div class="modal-body" id="addItem-body">
                <input type="text" ng-model="product_setup.search" class="input-large search-query" placeholder="Search term" /> <button class="btn" ng-click="product_setup.search='';get_products()">Clear</button><br/><br/>
                <table id="itemstbl" class="table table-hover table-bordered">
                    <thead>
                    <tr>
                        <th class="item_setup-sort item_setup-sort-name">
                            <a href="" ng-click="item_setup_opt('sort','name')">Item Name<span class="{{'caret-'+product_setup.order}}"></span></a>
                        </th>
                        <th class="item_setup-sort item_setup-sort-sku">
                            <a href="" ng-click="item_setup_opt('sort','sku')">Primary Sku<span class="{{'caret-'+product_setup.order}}"></span></a>
                        </th>
                        <th class="item_setup-sort item_setup-sort-status">
                            <a href="" ng-click="item_setup_opt('sort','status')">Status<span class="{{'caret-'+product_setup.order}}"></span></a>
                        </th>
                        <th class="item_setup-sort item_setup-sort-barcode">
                            <a href="" ng-click="item_setup_opt('sort','barcode')">Barcode<span class="{{'caret-'+product_setup.order}}"></span></a>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-click="add_item_order(product.id)" ng-repeat="product in products">
                        <td>{{product.name}}</td>
                        <td>{{product.sku}}</td>
                        <td>{{product.status}}</td>
                        <td>{{product.barcode}}</td>
                    </tr>
                    </tbody>
                </table>
                <button ng-show="new_products" class="btn btn-info btn-large" style="width:100%;" ng-click="product_next()">Load More</button>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
            </div>
        </div>



    </div>
</div>