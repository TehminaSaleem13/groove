<div class="row navigation-row">
    <div ng-include="'/assets/partials/navigation.html'"></div>
</div>

<div  class="row home-row">
    <div class="alert alert-danger" ng-show="show_error">
        <i class="icon icon-remove close pull-right" ng-click="show_error = false"></i>
        <p ng-repeat="msg in error_msg">{{msg}}</p>
    </div>
    <div class="alert alert-notice" ng-show="show_notice">
        <i class="icon icon-remove close pull-right" ng-click="show_notice = false"></i>
        <p ng-repeat="msg in notice_msg">{{msg}}</p>
    </div>
    <div class="alert alert-success" ng-show="show_success">
        <i class="icon icon-remove close pull-right" ng-click="show_success = false"></i>
        <p ng-repeat="msg in success_msg">{{msg}}</p>
    </div>
</div>

<div class="row home-row">
    <div class="row-fluid">
        <div class="span9">
            <div class="row-fluid">
                <div class="span5">
                    <div class="well small-well">
                        <h5> Ready for {{rf_state_text}} scan!</h5>
                        <input id="rf_input" type="text" ng-model="rf_input" class="span12" placeholder="{{ 'Scan '+rf_state_text +'...' }}"/>
                        <div class="text-center">
                            <h4 ng-show="rf_state=='ready_for_order'">Ready!</h4>
                            <h4 ng-show="rf_state=='ready_for_product'">{{ unscanned_count }} items left to scan</h4>
                        </div>
                        <div class="scan_table">
                            <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Product</th>
                                    <th>Qty</th>
                                </tr>
                                </thead>
                                <tbody ng-repeat="unscanned_item in unscanned_items">
                                <tr ng-show= "unscanned_item.product_type =='single'">
                                        
                                        <td ng-show= "unscanned_item.product_type =='single'">
                                        <div class="single-image">
                                            <img class="img-thumb" ng-src="{{ unscanned_item.image.image }}" />
                                        </div>
                                        </td>
                                        <td ng-show= "unscanned_item.product_type =='single'">
                                        {{ unscanned_item.name }}</td>
                                        <td ng-show= "unscanned_item.product_type =='single'">
                                        {{unscanned_item.qty_remaining}}</td>
                                </tr>

                                <tr ng-show= "unscanned_item.product_type =='individual'">
                                        <td class='scantable-greyedout'>
                                        <div class="single-image">
                                            <img class="img-thumb" ng-src="{{ unscanned_item.image.image }}" />
                                        </div>
                                        </td>
                                        <td class='scantable-greyedout'>
                                        {{ unscanned_item.name }}</td>
                                        <td class='scantable-greyedout'>
                                        {{unscanned_item.qty_remaining}}</td>
                                        <tr ng-repeat = 'child_item in unscanned_item.child_items'>
                                            <td>
                                            <div class="single-image">
                                                <img class="img-thumb" ng-src="{{ child_item.image.image }}" />
                                            </div>
                                            </td>
                                            <td>
                                            {{ child_item.name }}</td>
                                            <td>
                                            {{child_item.qty_remaining}}</td>
                                        </tr>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="span7">
                    <div class="well small-well">
                        <div class="text-center">
                            <div ng-show="rf_state=='ready_for_order'">
                                <h3>Please scan an Order to begin</h3>
                                <div class="pack_image"> <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>RFO back ground space<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></div>
                            </div>


                            <div ng-show="rf_state=='ready_for_product'">
                                <h3 ng-show="next_item.scanned ==0">Please scan this product next</h3>
                                <h3 ng-show="next_item.scanned !=0">{{next_item.scanned_qty}} of {{ next_item.qty }} have been scanned</h3>
                                <div class="text-left">
                                    <p><strong>Name: </strong>{{next_item.name}}</p>
                                    <p><strong>SKU:</strong> {{next_item.sku}}</p>
                                    <p><strong>{{next_item.qty_remaining}} more to scan.</strong></p>
                                </div>
                                <div class="scan_product_images">
                                    <div class="scan_product_times img-rounded" ng-show="next_item.qty > 1">
                                        <div class="text-center pull-left"><i class="icon icon-5x icon-remove"></i><br/>TIMES</div> <div class="times_number pull-right">{{next_item.qty}}</div>
                                    </div>
                                    <div ng-click="item_image_index = item_image_index + 1" ng-show="item_image_index < next_item.images.length - 1" class="nav-right img-circle"><i class="icon icon-2x icon-arrow-right"></i></div>
                                    <div ng-click="item_image_index = item_image_index - 1" ng-show="item_image_index > 0" class="nav-left img-circle"><i class="icon icon-2x icon-arrow-left"></i></div>
                                    <img ng-repeat="image in next_item.images" ng-show="item_image_index == $index" class="img-thumb" ng-src="{{ image.image }}" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span6">
                    <div class="well small-well">
                        <fieldset>
                            <legend>Handling Instructions for this Order</legend>
                            <p>{{ order_details.instructions}}</p>
                        </fieldset>
                    </div>
                </div>
                <div class="span6">
                    <div class="well small-well">
                        <fieldset>
                            <legend>Special Instructions for this Product</legend>
                            <p>{{ next_item.instructions}}</p>
                        </fieldset>
                    </div>
                </div>
            </div>
        </div>
        <div class="span3">
            <div class="well small-well">
                <div class="text-center">
                    <div class="pack_image">
                        <h4 ng-show="rf_state=='ready_for_product'">{{ scanned_count }} items scanned</h4>
                        <img src="/images/bcqc_box.png" alt="products to scan" />
                    </div>
                </div>
                <div class="scan_table">
                    <table class="table table-hover" >
                        <thead>
                        <tr>
                            <th>Product</th>
                            <th>Scanned</th>
                        </tr>
                        </thead>
                        <tbody ng-repeat="scanned_item in scanned_items">
                        <tr ng-show= "scanned_item.product_type =='single'">
                                
                                <td ng-show= "scanned_item.product_type =='single'">
                                {{ scanned_item.name }}</td>
                                <td ng-show= "scanned_item.product_type =='single'">
                                {{scanned_item.scanned_qty}}</td>
                        </tr>

                        <tr ng-show= "scanned_item.product_type =='individual'">

                                <td class='scantable-greyedout'>
                                {{ scanned_item.name }}</td>
                                <td class='scantable-greyedout'>
                                {{scanned_item.scanned_qty}}</td>
                                <tr ng-repeat = 'child_item in scanned_item.child_items'>
                                    <td>
                                    {{ child_item.name }}</td>
                                    <td>
                                    {{child_item.scanned_qty}}</td>
                                </tr>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <fieldset>
                    <legend>Packing Stats</legend>
                    <p>Current Order Bonus : {{cur_order_bonus}}</p>
                    <p>Session Bonus : {{session_bonus}}</p>
                    <p>Scan Accuracy : {{scan_accuracy}}</p>
                    <p>Last Product Time : {{last_product_time}}</p>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<div id="showOrderConfirmation" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="showOrderConfirmation"
     aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
        <h3 id="showOrderConfirmationHeader" >Scan Confirmation Code with 'Order edit' permission</h3>
    </div>
    <div class="form-horizontal form-horizontal-create" >
        <fieldset>
            <div class="modal-body" id="showOrderConfirmation-body">
                <div class="alert alert-danger" ng-show="show_error_msgs">
                    <button type="button" class="close" data-dismiss="alert"><i class="icon-remove"></i></button>
                    <p ng-repeat="message in error_msgs">{{message}}</p>
                </div>
                <div class="control-group">
                    <label class="control-label">Confirmation Code</label>
                    <div class="controls">
                        <input id="order_edit_confirmation_code" type="text" ng-model="order_confirmation_code" />
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    </div>
</div>

<div id="showProductConfirmation" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="showProductConfirmation"
     aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
        <h3 id="showProductConfirmationHeader" >Scan Confirmation Code with 'Product edit' permission</h3>
    </div>
    <div class="form-horizontal form-horizontal-create" >
        <fieldset>
            <div class="modal-body" id="showProductConfirmation-body">
                <div class="alert alert-danger" ng-show="show_error_msgs">
                    <button type="button" class="close" data-dismiss="alert"><i class="icon-remove"></i></button>
                    <p ng-repeat="message in error_msgs">{{message}}</p>
                </div>
                <div class="control-group">
                    <label class="control-label">Confirmation Code</label>
                    <div class="controls">
                        <input id="product_edit_confirmation_code" type="text" ng-model="product_confirmation_code" />
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    </div>
</div>

<div id="showProduct" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="showProduct"
     aria-hidden="true">

    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
        <h3 id="showProductHeader" >Editing: {{single_product.skus[0].sku}}  - ID #{{single_product.basicinfo.id}}</h3>
    </div>
    <div class="form-horizontal form-horizontal-create" >
        <fieldset>
            <div class="modal-body" id="showProduct-body">
                <div class="alert alert-danger" ng-show="show_error_msgs">
                    <button type="button" class="close" data-dismiss="alert"><i class="icon-remove"></i></button>
                    <p ng-repeat="message in error_msgs">{{message}}</p>
                </div>

                <table class="product_single_top_table">
                    <tr>
                        <td>
                            <h4>{{single_product.basicinfo.name}}</h4>
                            <h4>SKU# {{single_product.skus[0].sku}}</h4>
                        </td>
                        <td class="span6">
                            <p>&nbsp;</p>
                        </td>
                        <td>
                            <h5>Status </h5>
                            <label class="radio"><input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.status" value="active"> Active </label>
                            <label class="radio"><input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.status" value="inactive"> Inactive </label>
                            <label class="radio"><input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.status" value="new"> New  </label>
                        </td>
                    </tr>
                </table>

                <h5>Product Images</h5>
                <div class="control-group">
                    <div ui-sortable="sortableOptions" ng-model="single_product.images">
                        <div class="single-image" ng-class="{'primary-image': $index==0}" ng-repeat="image in single_product.images">
                            <img ng-src="{{ image.image }}" class="img-polaroid img-thumb"/>
                            <i class="icon-remove" ng-click="remove_node('image',$index)"></i>
                        </div>
                    </div>
                    <div ng-hide="true">
                        <input name="product_image" id="product_image" file-upload type="file" value="Add Image" required/>
                    </div>
                    <button class="btn" ng-click="add_image()" >Add Image</button>
                </div>

                <h5>Product Details</h5>
                <div class="control-group">
                    <label class="control-label">Name</label>
                    <div class="controls">
                        <input xs-input-sync type="text" ng-model="single_product.basicinfo.name" class="regular-input span8" />
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">SKUs</label>
                    <div class="controls">
                        <div id="sku" ng-click="focus_input('sku')" class="input-text uneditable-input span8">
                            <div ui-sortable="sortableOptions" ng-model="single_product.skus">
                                <div class="tag-bubble" id="sku-{{$index}}" ng-dblclick="edit_node('sku',$index)" ng-repeat="sku in single_product.skus">
                                    {{sku.sku}}
                                    <i ng-show="tmp.editing_var == 'sku' && tmp.editing == $index && tmp.sku != ''" class="icon-ok" ng-click="save_node('sku')"></i>
                                    <i ng-show="tmp.editing_var != 'sku' || tmp.editing != $index" class="icon-pencil" ng-click="edit_node('sku',$index)"></i>
                                    <i class="icon-remove" ng-click="remove_node('sku',$index)"></i>
                                </div>
                            </div>
                            <div id="sku-input" class="tag-bubble false-tag-bubble">
                                <input xs-input-sync name="sku" ng-model="tmp.sku" type="text" placeholder="Add..." />
                                <i ng-show="tmp.editing == -1 && tmp.sku != ''" class="icon-ok" ng-click="save_node('sku')"></i>
                                <i ng-show="tmp.editing == -1" class="icon-remove" ng-click="blur_input('sku')"></i>
                            </div>
                        </div>
                        <i class="icon-large  icon-question-sign" data-toggle="popover" data-placement="top" data-content="The first SKU listed is the Primary SKU.
                                                 It will be displayed during packing. Additional alias SKUs can be added by comma or enter."  data-original-title=""></i>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Special instructions for Packer</label>
                    <div class="controls">
                        <textarea xs-input-sync ng-model="single_product.basicinfo.spl_instructions_4_packer" class="span8 regular-input" rows="4"></textarea>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Packer Confirmation</label>
                    <div class="controls">
                        <label class="radio inline">
                            <input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.spl_instructions_4_confirmation" value="1" /> Required
                        </label>
                        <label class="radio inline">
                            <input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.spl_instructions_4_confirmation" value="0" /> Not Required
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Barcodes</label>
                    <div class="controls">
                        <div id="barcode" ng-click="focus_input('barcode')"  class="input-text uneditable-input span8">
                            <div ng-model="single_product.barcodes">
                                <div class="tag-bubble" id="barcode-{{$index}}" ng-dblclick="edit_node('barcode',$index)" ng-repeat="barcode in single_product.barcodes">
                                    {{barcode.barcode}}
                                    <i ng-show="tmp.editing_var == 'barcode' && tmp.editing == $index && tmp.barcode != ''" class="icon-ok" ng-click="save_node('barcode')"></i>
                                    <i ng-show="tmp.editing_var != 'barcode' || tmp.editing != $index" class="icon-pencil" ng-click="edit_node('barcode',$index)"></i>
                                    <i class="icon-remove" ng-click="remove_node('barcode',$index)"></i>
                                </div>
                            </div>
                            <div id="barcode-input" class="tag-bubble false-tag-bubble">
                                <input xs-input-sync name="barcode" ng-model="tmp.barcode" type="text" placeholder="Add..." />
                                <i ng-show="tmp.editing == -1 && tmp.barcode != ''" class="icon-ok" ng-click="save_node('barcode')"></i>
                                <i ng-show="tmp.editing == -1" class="icon-remove" ng-click="blur_input('barcode')"></i>
                            </div>
                        </div>
                        <label ng-show="single_product.barcodes == '' && tmp.barcode == '' " class="checkbox inline">
                            <input type="checkbox" ng-click="update_single_product()" ng-model="single_product.basicinfo.disable_conf_req" /> Disable Confirmation Requests
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Product can be skipped</label>
                    <div class="controls">
                        <label class="radio inline">
                            <input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.is_skippable" value="1" /> Yes
                        </label>
                        <label class="radio inline">
                            <input type="radio" ng-click="update_single_product()" ng-model="single_product.basicinfo.is_skippable" value="0" /> No
                        </label>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Categories</label>
                    <div class="controls">
                        <div id="category" ng-click="focus_input('category')" class="input-text uneditable-input span8">
                            <div ng-model="single_product.cats">
                                <div class="tag-bubble" id="category-{{$index}}" ng-dblclick="edit_node('category',$index)" ng-repeat="category in single_product.cats">
                                    {{category.category}}
                                    <i ng-show="tmp.editing_var == 'category' && tmp.editing == $index && tmp.category != ''" class="icon-ok" ng-click="save_node('category')"></i>
                                    <i ng-show="tmp.editing_var != 'category' || tmp.editing != $index" class="icon-pencil" ng-click="edit_node('category',$index)"></i>
                                    <i class="icon-remove" ng-click="remove_node('category',$index)"></i>
                                </div>
                            </div>
                            <div id="category-input" class="tag-bubble false-tag-bubble">
                                <input xs-input-sync name="category" ng-model="tmp.category" type="text" placeholder="Add..." />
                                <i ng-show="tmp.editing == -1 && tmp.category != ''" class="icon-ok" ng-click="save_node('category')"></i>
                                <i ng-show="tmp.editing == -1" class="icon-remove" ng-click="blur_input('category')"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Packing placement</label>
                    <div class="controls">
                        <input type="number" min="1" max="100"  ng-model="single_product.basicinfo.packing_placement" />
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label">Packing time adjustment</label>
                    <div class="controls">
                        <input type="number" ng-model="single_product.basicinfo.pack_time_adj" />
                    </div>
                </div>
                <h5>Inventory and Location by Warehouses</h5>
                <table class="table table-hover table-bordered table-striped table-condensed">
                    <thead>
                    <tr>
                        <th>Warehouse Name</th>
                        <th>Quantity on Hand</th>
                        <th>Primary Location</th>
                        <th>Secondary Location</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="warehouse in single_product.inventory_warehouses" ng-class="{info:warehouse.checked}" ng-click="select_deselect_warehouse(warehouse)">
                        <td ng-dblclick="edit_warehouse_node($index,warehouse.id,'name')">
                            {{warehouse.name}}
                            <div ng-show="warehouse_edit_tmp.editing == $index && warehouse_edit_tmp.editing_var == 'name'" class="tag-bubble tag-bubble-input span3 input-text">
                                <input xs-input-sync class="span3" name="{{'warehouse_name_'+$index}}" ng-model="warehouse_edit_tmp.name" type="text" placeholder="Edit..." />
                                <i ng-show="warehouse_edit_tmp.editing != -1" class="icon-ok" ng-click="save_warehouse_node()"></i>
                            </div>
                        </td>

                        <td ng-dblclick="edit_warehouse_node($index,warehouse.id,'qty')">
                            {{warehouse.qty}}
                            <div ng-show="warehouse_edit_tmp.editing == $index && warehouse_edit_tmp.editing_var == 'qty'" class="tag-bubble tag-bubble-input span3 input-text">
                                <input type="number" min="0" class="span3" name="{{'warehouse_qty_'+$index}}" ng-model="warehouse_edit_tmp.qty" />

                                <i class="icon-ok" ng-click="save_warehouse_node()"></i>
                            </div>
                        </td>

                        <td ng-dblclick="edit_warehouse_node($index,warehouse.id,'location_primary')">
                            {{warehouse.location_primary}}
                            <div ng-show="warehouse_edit_tmp.editing == $index && warehouse_edit_tmp.editing_var == 'location_primary'" class="tag-bubble tag-bubble-input span3 input-text">
                                <input xs-input-sync class="span3" name="{{'warehouse_location_primary_'+$index}}" ng-model="warehouse_edit_tmp.location_primary" type="text" placeholder="Edit..." />
                                <i class="icon-ok" ng-click="save_warehouse_node()"></i>
                            </div>
                        </td>
                        <td ng-dblclick="edit_warehouse_node($index,warehouse.id,'location_secondary')">
                            {{warehouse.location_secondary}}
                            <div ng-show="warehouse_edit_tmp.editing == $index && warehouse_edit_tmp.editing_var == 'location_secondary'" class="tag-bubble tag-bubble-input span3 input-text">
                                <input xs-input-sync class="span3" name="{{'warehouse_location_secondary_'+$index}}" ng-model="warehouse_edit_tmp.location_secondary" type="text" placeholder="Edit..." />
                                <i class="icon-ok" ng-click="save_warehouse_node()"></i>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <button class="btn btn-success" ng-click="add_warehouse()">Add warehouse</button>
                <button ng-click="remove_warehouses()" class="btn btn-danger" >Remove selected</button>
            </div>
        </fieldset>
        <div class="modal-footer">
            <div class="row-fluid">
                <div class="span6">
                    <span class="label label-info" id="product_update_status" ng-show="product_update_status">{{product_update_message}}</span>
                </div>
                <div class="span6">
                    <div class="pull-right">
                        <button ng-click="update_single_product()" data-dismiss="modal" class="btn btn-primary" >Save</button>
                        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- Product modal ends -->

<!-- Product list Modal -->
<div id="showProductList" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="showProductList"
     aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
        <h3 id="showProductListHeader" >Items in current Order</h3>
    </div>
    <div class="modal-body" id="showProductList-body">
        <div class="alert alert-danger" ng-show="show_error_msgs">
            <button type="button" class="close" data-dismiss="alert"><i class="icon-remove"></i></button>
            <p ng-repeat="message in error_msgs">{{message}}</p>
        </div>
        <table id="orderitemstbl" class="table table-hover table-bordered">
            <thead>
            <tr>
                <th>Item Name</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody>

            <tr ng-repeat="item in inactive_new_products">
                <td><a href="#showProduct" role="button" data-toggle="modal" ng-click="product_single_details(item.id,$index)" class="ng-binding">{{item.name}}</a></td>
                <td>{{item.status}}</td>
            </tr>
            </tbody>
        </table>

    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    </div>
</div>
<!-- Product list Modal ends-->
